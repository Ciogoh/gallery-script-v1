let img;let renderBuffer;let inputImg, inputChars, inputRes, inputContrast, inputThreshold, inputLeading, inputJitter, inputRotation;let selFont, pickerText, pickerBg, checkColor, checkVariableSize, checkInvert;let myText = "?"; const sidebarWidth = 260;function setup() {  let canvas = createCanvas(windowWidth - sidebarWidth, windowHeight);  canvas.position(sidebarWidth, 0);  pixelDensity(1);    let sidebar = createDiv('');  styleSidebar(sidebar);  createP('COMPUTER ART <span style="color:#666">v3.2</span>')    .parent(sidebar)    .style('font-weight', 'bold').style('font-size', '12px').style('letter-spacing', '1.5px').style('margin-bottom', '30px');  createLabel('FILE INPUT', sidebar);  inputImg = createFileInput(handleFile).parent(sidebar);    createLabel('CHARACTERS', sidebar);  inputChars = createInput(myText).parent(sidebar);  inputChars.addClass('custom-input').input(() => { myText = inputChars.value(); loop(); });  createLabel('TYPOGRAPHY', sidebar);  selFont = createSelect().parent(sidebar);  selFont.addClass('custom-select');  ['Monospace', 'Helvetica', 'Impact', 'Georgia'].forEach(f => selFont.option(f));    createLabel('GRID RESOLUTION', sidebar);  inputRes = createSlider(5, 100, 18, 1).parent(sidebar);   inputLeading = createSlider(0.5, 2.5, 1.0, 0.1).parent(sidebar);  createLabel('TRANSFORM', sidebar);  inputRotation = createSlider(0, TWO_PI, 0, 0.01).parent(sidebar);  inputJitter = createSlider(0, 50, 0, 1).parent(sidebar);  createLabel('COLOR & MODE', sidebar);  let rowColor = createDiv('').parent(sidebar).style('display', 'flex').style('gap', '10px').style('margin-bottom', '10px');  pickerText = createColorPicker('#00fbff').parent(rowColor);  pickerBg = createColorPicker('#0a0a0a').parent(rowColor);    checkColor = createCheckbox(' Use Image Colors', false).parent(sidebar).addClass('custom-check');  checkVariableSize = createCheckbox(' Adaptive Weight', true).parent(sidebar).addClass('custom-check');  checkInvert = createCheckbox(' Invert Mode', false).parent(sidebar).addClass('custom-check');  createLabel('PROCESSING', sidebar);  inputContrast = createSlider(1, 5, 1.5, 0.1).parent(sidebar);  inputThreshold = createSlider(0, 255, 127, 5).parent(sidebar);  let uiElements = [selFont, inputRes, inputLeading, inputRotation, inputJitter, pickerText, pickerBg, checkColor, checkVariableSize, checkInvert, inputContrast, inputThreshold];  uiElements.forEach(el => el.input(loop));  let btnSave = createButton('DOWNLOAD RENDER').parent(sidebar);  btnSave.addClass('save-button').mousePressed(exportHighRes);  noLoop();}function draw() {  background(15);   if (!img) {    fill(100); textAlign(CENTER, CENTER);    text("AWAITING IMAGE SOURCE...", width/2, height/2);    return;  }  if (!renderBuffer || renderBuffer.width !== img.width) {    renderBuffer = createGraphics(img.width, img.height);  }  renderArt(renderBuffer);  addFooter(renderBuffer);   let previewScale = min((width - 60) / img.width, (height - 60) / img.height);  push();  translate(width/2, height/2);  imageMode(CENTER);  image(renderBuffer, 0, 0, img.width * previewScale, img.height * previewScale);  pop();    noLoop(); }function renderArt(pg) {  pg.background(pickerBg.color());  let tempImg = img.get();  tempImg.loadPixels();  let res = inputRes.value();  let lead = inputLeading.value();  let jitter = inputJitter.value();  let rot = inputRotation.value();  let thresh = inputThreshold.value();  let contrast = inputContrast.value();  let charIndex = 0;    // Definizione Safe Zone (Area del Footer)  let safeW = pg.width * 0.35; // Copre il 35% della larghezza  let safeH = pg.height - (pg.height * 0.08); // Inizia dall'8% dal fondo    pg.textFont(selFont.value());  pg.textAlign(CENTER, CENTER);  for (let y = 0; y < tempImg.height; y += res * lead) {    for (let x = 0; x < tempImg.width; x += res) {            // LOGICA SAFE ZONE: se siamo nell'angolo in basso a sinistra, salta il disegno      if (x < safeW && y > safeH) continue;      let i = (floor(x) + floor(y) * tempImg.width) * 4;      let r = tempImg.pixels[i];      let g = tempImg.pixels[i+1];      let b = tempImg.pixels[i+2];      r = constrain((r - 128) * contrast + 128, 0, 255);      g = constrain((g - 128) * contrast + 128, 0, 255);      b = constrain((b - 128) * contrast + 128, 0, 255);      let bright = (r + g + b) / 3;      let shouldDraw = checkInvert.checked() ? (bright > thresh) : (bright < thresh);      if (shouldDraw) {        pg.push();        pg.translate(x + random(-jitter, jitter), y + random(-jitter, jitter));        pg.rotate(rot);        let dSize = res;        if (checkVariableSize.checked()) {          dSize = checkInvert.checked() ?                   map(bright, thresh, 255, 0, res * 2) :                   map(bright, 0, thresh, res * 2, 0);        }                pg.textSize(max(dSize, 0.1));        pg.fill(checkColor.checked() ? color(r, g, b) : pickerText.color());        pg.text(myText.charAt(charIndex % myText.length), 0, 0);        pg.pop();        charIndex++;      }    }  }}function addFooter(buffer) {  buffer.push();  let m = buffer.width * 0.03; // Margine dinamico proporzionale  let cFooter = color(pickerText.color());    // Linea estetica  cFooter.setAlpha(80);  buffer.stroke(cFooter);  buffer.strokeWeight(buffer.width * 0.001);  buffer.line(m, buffer.height - (buffer.height * 0.05), m + (buffer.width * 0.05), buffer.height - (buffer.height * 0.05));  // Riga Tecnica  buffer.noStroke();  cFooter.setAlpha(100);  buffer.fill(cFooter);  buffer.textFont('Helvetica');  buffer.textSize(buffer.height * 0.012);   buffer.textAlign(LEFT, BOTTOM);  buffer.text("2025 Vibe-Code Exercise", m, buffer.height - (buffer.height * 0.032));    // Firma  cFooter.setAlpha(220);  buffer.fill(cFooter);  buffer.textStyle(BOLD);  buffer.textSize(buffer.height * 0.018);  buffer.text("Alice Federici", m, buffer.height - (buffer.height * 0.012));  buffer.pop();}// Funzioni di supporto (invariate)function handleFile(file) { if (file.type === 'image') { img = loadImage(file.data, () => loop()); } }function createLabel(t, p) { createP(t).parent(p).style('font-size', '9px').style('color', '#555').style('margin', '20px 0 8px 0').style('text-transform', 'uppercase').style('letter-spacing', '1.2px'); }function styleSidebar(s) {  s.style('width', sidebarWidth+'px').style('height', '100%').style('position', 'fixed').style('left', '0').style('top', '0');  s.style('background', '#0a0a0a').style('color', '#fff').style('padding', '30px').style('font-family', 'Inter, sans-serif').style('border-right', '1px solid #1a1a1a').style('overflow-y', 'auto');  let style = createElement('style', `.custom-input { background: #151515; border: 1px solid #222; color: #fff; padding: 8px; border-radius: 4px; font-family: monospace; width: 100%; } .custom-select { background: #151515; border: 1px solid #222; color: #fff; padding: 5px; width: 100%; border-radius: 4px; } .custom-check { font-size: 11px; color: #888; margin-bottom: 5px; display: block; } .save-button { background: #fff; color: #000; border: none; padding: 12px; font-weight: bold; width: 100%; margin-top: 30px; cursor: pointer; border-radius: 4px; transition: 0.2s; } .save-button:hover { background: #00fbff; } input[type=range] { width: 100%; margin-bottom: 5px; }`);}function exportHighRes() { if (renderBuffer) save(renderBuffer, 'studio_render.png'); }function windowResized() { resizeCanvas(windowWidth - sidebarWidth, windowHeight); loop(); }